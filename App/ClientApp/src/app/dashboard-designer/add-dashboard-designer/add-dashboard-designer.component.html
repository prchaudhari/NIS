<div class='top-bar fixed'>
  <button class="fa float-left hamburger-dashboard"
          [ngClass]="isWidgetSidebar? 'fa-arrow-left' : 'fa-bars'"
          (click)="isWidgetSidebar =!isWidgetSidebar"></button>
  <span class="dashboard-title d-none d-sm-block">Display Name | {{PageName}} </span>
  <div class="page-title d-flex justify-content-md-between justify-content-end d-sm-none">
    <div class="xs-title">
      Display Name, {{PageName}}
    </div>
  </div>
  <div class="float-right pr-2 d-md-block d-none">
    <button class="btn-footer-fill mt-2 mr-2" id="btnPrev" title="Previous" [disabled]="isMasterSaveBtnDisabled" (click)="prevBtnClicked()"> Prev</button>
    <button class="btn-footer-fill mt-2 mr-2" id="btnSave" title="Save" [disabled]="isMasterSaveBtnDisabled" (click)="OnSaveBtnClicked()"> Save</button>
    <button class="btn-footer-outline mt-2" id="btnCancel" title="Cancel" (click)="backClicked()"> Cancel </button>
  </div>
  <div class="float-right pr-2 d-md-none">
    <!-- <span class="fa fa- xs-position1 d-md-none" (click)="OnSaveBtnClicked()"></span> -->
    <span class="fa fa-check xs-position1 d-md-none" (click)="OnSaveBtnClicked()"></span>
    <span class="fa fa-close xs-position2 d-md-none" (click)="backClicked()" id="spnMachineBack"></span>
  </div>
</div>

<div class="dashboard-container">
  <div class="widget-sidebar stylescrollbar" [ngClass]="isWidgetSidebar? 'show-sidebar show-sidebar-widget':'hide-sidebar'">
    <ul class="side-bar-ul">
      <li class="side-bar-li" title={{widgetType.title}} *ngFor="let widgetType of widgetsArray">
          <a (click)="selectWidget(widgetType.type)">
              <span class="nav-icon fa" [ngClass]="{
                  'fa-address-book-o': widgetType.type == 'customerInformation',
                  'fa-address-card-o' : widgetType.type == 'accountInformation',
                  'fa-image fa-lg' : widgetType.type == 'image',
                  'icon-videoWidget' : widgetType.type == 'video',
                  'icon-widget-single-column2 fa-lg' : widgetType.type == 'summaryAtGlance',
                  'fa-bell-o fa-lg' : widgetType.type == 'reminderAndRecommendation',
                  'icon-rp-loss1 fa-lg' : widgetType.type == 'investmentPortfolioRisk',
                  'icon-AnalyticsWidget' : widgetType.type == 'analytics',
                  'icon-AvailableBalanceWidget' : widgetType.type == 'availableBalance',
                  'icon-widget-multi-column2' : widgetType.type == 'transactionList',
                  'icon-widget-line-chart2' : widgetType.type == 'savingTrend',
                  'icon-TransactionMixWidget' : widgetType.type == 'transactionMix',
                  'icon-rp-production1' : widgetType.type == 'spendingTrend',
                  'fa-newspaper-o' : widgetType.type == 'newsAlerts',
                  'fa-credit-card' : widgetType.type == 'transactionDetails',
                  'icon-rp-quality1' : widgetType.type == 'top4IncomeSources'
              }">
          </span><span class="nav-title"> {{widgetType.title}} </span>
          </a>
      </li>
  </ul>
  </div>

  <div class="overlay" [ngClass]="isWidgetSidebar? 'show' : 'hide'"></div>
  <div class="dashboard-inner-container">
    <div class="widget-container">
      <gridster [options]="options">        
        <gridster-item  [item]="item" *ngFor="let item of widgetsGridsterItemArray">
          <button class='fa fa-trash-o widget-action' (click)="removeItem($event,item)"></button>
          <button class='fa fa-gear mr-3 widget-action' (click)="isImageConfigForm(item.widgetId, item.widgetItemCount)" *ngIf="item.value=='image'"></button>
          <button class='fa fa-gear mr-3 widget-action' (click)="isVideoConfigForm(item.widgetId, item.widgetItemCount)" *ngIf="item.value=='video'"></button>
          <ndc-dynamic [ndcDynamicComponent]="item.component"></ndc-dynamic>
      </gridster-item>
      </gridster>
    </div>
  </div>

  <!--image config-->
  <form [formGroup]="ImageConfigForm" name="imgConfigform">
    <div class="form-popup side-popup width340" [ngClass]="isImageConfig? 'show' : 'hide'">
      <div class="filter-head">
        <label class="m-0">Image Configuration</label>
      </div>
      <div class="filter-body stylescrollbar">
        <div class="row">
          <div class="col-sm-12 form-group">
            <label> Personalize </label>
            <div>
              <label class="switch d-block">
                <input type="checkbox" [checked]="isPersonalizeImage" (change)="isPersonalizeImage=!isPersonalizeImage">
                <span class="slider round"></span>
              </label>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="!isPersonalizeImage">
          <div class="col-sm-12 form-group">
            <label> Asset Library </label> <span class="text-danger"> *</span>
            <select formControlName="imgAssetLibrary" (change)="onAssetLibrarySelected($event, 'image')" class="form-control" >
              <option *ngFor="let al of assetLibraryList" [value]="al.Identifier">{{al.Name}}</option>
            </select>
            <div class="validation-msg" style="color:red">
              <ul style="list-style-type:none" *ngIf="imageFormErrorObject.showAssetLibraryError">
                <li class="text-danger">Please select asset library</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="!isPersonalizeImage">
          <div class="col-sm-12 form-group">
            <label> Assets </label> <span class="text-danger"> *</span>
            <select class="form-control" formControlName="imgAsset" (change)="onAssetSelected($event, 'image')">
              <option *ngFor="let ast of assets" [value]="ast.Identifier">{{ast.Name}}</option>
            </select>
            <div class="validation-msg" style="color:red">
              <ul style="list-style-type:none" *ngIf="imageFormErrorObject.showAssetError">
                <li class="text-danger">Please select asset</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="!isPersonalizeImage">
          <div class="col-sm-12">
            <label> Target Link </label> <span class="text-danger"> *</span>
            <input type="text" class="form-control" formControlName="imageUrl"/>
            <div class="validation-msg" style="color:red" *ngIf="imgForm.imageUrl.touched && imgForm.imageUrl.errors">
              <ul style="list-style-type:none">
                <li class="text-danger" *ngIf="imgForm.imageUrl.errors?.required">
                  Target link required
                </li>
                <li class="text-danger" *ngIf="imgForm.imageUrl.errors?.pattern">
                  Invalid target link
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="filter-footer">
        <ul class="nav nav-toolbar">
          <li class="nav-item width50">
            <button title="Save" id="btnCloseForm" [disabled]="saveImgFormValidation()" (click)="OnImageConfigBtnClicked('submit')" class="btn-footer-fill btn-block rounded-0 height100" >
              <span class="fa fa-check"></span>
            </button>
          </li>
          <li class="nav-item width50" (click)="OnImageConfigBtnClicked('cancel')">
            <button title="Close" id="btnCloseForm" class="btn-footer-fill btn-block rounded-0 height100">
              <span class="fa fa-close"></span>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </form>

  <!--video config-->
  <form [formGroup]="VideoConfigForm" name="vdoConfigform">
    <div class="form-popup side-popup width340" [ngClass]="isVideoConfig? 'show' : 'hide'">
      <div class="filter-head">
        <label class="m-0">Video Configuration</label>
      </div>
      <div class="filter-body stylescrollbar">
        <div class="row">
          <div class="col-sm-6 form-group">
            <label> Personalize </label>
            <div>
              <label class="switch d-block">
                <input type="checkbox" [checked]="isPersonalize" (change)="isPersonalize=!isPersonalize">
                <span class="slider round"></span>
              </label>
            </div>
          </div>
          <div class="col-sm-6 form-group">
            <label> Embedded </label>
            <div>
              <label class="switch d-block">
                <input type="checkbox" (change)="isEmbedded=!isEmbedded">
                <span class="slider round" [ngClass]="!isPersonalize ? 'disabled-cursor bg-secondary':''"></span>
              </label>
            </div>
          </div>
        </div>
        <div>
          <div class="row" *ngIf="(isEmbedded && isPersonalize) || isEmbedded">
            <div class="col-sm-12 form-group">
              <label> URL </label> <span class="text-danger"> *</span>
              <input type="text" class="form-control" formControlName="vdoUrl"/>
              <div class="validation-msg" style="color:red" *ngIf="vdoForm.vdoUrl.touched && vdoForm.vdoUrl.errors">
                <ul style="list-style-type:none">
                  <li class="text-danger" *ngIf="vdoForm.vdoUrl.errors?.required">
                    URL is required
                  </li>
                  <li class="text-danger" *ngIf="vdoForm.vdoUrl.errors?.pattern">
                    Invalid URL
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row" *ngIf="!isEmbedded && !isPersonalize">
            <div class="col-sm-12 form-group">
              <label> Asset Library </label> <span class="text-danger"> *</span>
              <select class="form-control" formControlName="vdoAssetLibrary" (change)="onAssetLibrarySelected($event, 'video')">
                <option *ngFor="let al of assetLibraryList" [value]="al.Identifier">{{al.Name}}</option>
              </select>
              <div class="validation-msg" style="color:red">
                <ul style="list-style-type:none" *ngIf="videoFormErrorObject.showAssetLibraryError">
                  <li class="text-danger">Please select asset library</li>
                </ul>
              </div>             
            </div>
          </div>
          <div class="row" *ngIf="!isEmbedded && !isPersonalize">
            <div class="col-sm-12 form-group">
              <label> Assets </label> <span class="text-danger"> *</span>
              <select class="form-control" formControlName="vdoAsset" (change)="onAssetSelected($event, 'video')">
                <option *ngFor="let ast of assets" [value]="ast.Identifier">{{ast.Name}}</option>
              </select>
              <div class="validation-msg" style="color:red">
                <ul style="list-style-type:none" *ngIf="videoFormErrorObject.showAssetError">
                  <li class="text-danger">Please select asset</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        
      </div>
      <div class="filter-footer">
        <ul class="nav nav-toolbar">
          <li class="nav-item width50">
            <button title="Save" id="btnCloseForm" class="btn-footer-fill btn-block rounded-0 height100" [disabled]="saveVideoFormValidation()"
            (click)="OnVideoConfigBtnClicked('submit')">
              <span class="fa fa-check"></span>
            </button>
          </li>
          <li class="nav-item width50" (click)="OnVideoConfigBtnClicked('cancel')">
            <button title="Close" id="btnCloseForm" class="btn-footer-fill btn-block rounded-0 height100">
              <span class="fa fa-close"></span>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </form>
  
</div>

<div class="overlay a" id="divOverlayFilter" [ngClass]="!isImageConfig? 'hide':'show'"></div>
<div class="overlay a" id="divOverlayFilter" [ngClass]="!isVideoConfig? 'hide':'show'"></div>
